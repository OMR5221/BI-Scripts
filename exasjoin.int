// Script generated by DI Visual Integrator

version "1";

//+ This script contains objects or tasks that have been disabled in Visual Integrator.
//+ Use Visual Integrator to enable them.

object 'PARM' "Parms" {
	parms = {
		{
			name = "ST"
		},
		{
			name = "WH"
		}
	}
};

object 'TSKL' "Main" {
	contents = {
		`Join Tables and Split on Time`
	}
};

object 'TASK' "Join Tables and Split on Time" {
	inputs    = {
		`Transaction History`,
		`Time Lookup`,
		`Item Master`,
		`Planner VRC Groups`,
		`Planner Goals`,
		`Planner Goals Master`,
		`Planner Goals Ranges`,
		`Salesman/Customer Crossref`,
		`Warehouse Master`,
		`Salesman Master`,
		`Customer Master`,
		`Planner Check`,
		`Vendor Time`,
		`New Customer Master`
	},
	processes = {
		`Time Calcs`,
		`Join Time Lookup`,
		`Join Item Master`,
		`Calc Planner VRC Groups`,
		`Join Planner VRC Groups`,
		`squash Planner goals`,
		`sort Planner goals`,
		`Filter Planner Goals Master`,
		`Join Planner Goals Master`,
		`Join Planner Goals Ranges`,
		`Filter Planner Goals`,
		`Planner Goals Calcs`,
		`rotate Planner Goals`,
		`Planner Goals Final Calcs`,
		`Planner Goals Alias`,
		`Join Planner Goals`,
		`Join SC Xref`,
		`Join Salesman Master`,
		`Join Customer Master`,
		`Join Warehouse Master`,
		`Join Planner Check`,
		`Do Calcs`,
		`Vendor Calcs`,
		`Join Vendor Time`,
		`Filter`,
		`concat-1-CON`
	},
	output    = `Split`
};

object 'INPT' "Transaction History" {
	//+ coordinatex = `383`,
	//+ coordinatey = `8`,
	input_type  = `Filein`,
	filenames   = { `../temp/$WH-as=$ST.txt` },
	dictfile    = `../temp/as.dic`
};

object 'INPT' "Time Lookup" {
	//+ coordinatex = `383`,
	//+ coordinatey = `158`,
	input_type  = `Filein`,
	file_type   = `column_headers`,
	filenames   = { `../temp/whtimelookup.txt` }
};

object 'INPT' "Item Master" {
	//+ coordinatex = `533`,
	//+ coordinatey = `83`,
	input_type  = `Filein`,
	filenames   = { `../data/gowimpdd.csv` },
	dictfile    = `../programs/gowimp.dic`,
	aliases     = {
		`Fiscal Month Count=`,
		`Vendor Report Code Number=Vendor RC# Base`
	}
};

object 'INPT' "Planner VRC Groups" {
	//+ coordinatex = `533`,
	//+ coordinatey = `158`,
	input_type  = `Filein`,
	filenames   = { `../data/vrc-groups.txt` },
	file_type   = `column_headers`,
	aliases     = {
		`Vendor Report Code Number=Vendor RC# Base`,
		`State=Warehouse State`
	}
};

object 'INPT' "Planner Goals" {
	//+ coordinatex = `8`,
	//+ coordinatey = `233`,
	input_type      = `filein`,
	filenames       = { `../../global/temp/planner_goals_list.txt` },
	file_type       = `column_headers`,
	filename_column = `Filename`,
	aliases         = {
		`Year-Month=TY Year-Month`,
		`Program=Quota Description`,
		`Goal ID=Quota Number`
	},
	keep_columns    = {
		`Quota Number`,
		`Quota Description`,
		`TY Year-Month`
	}
};

object 'INPT' "Planner Goals Master" {
	//+ coordinatex = `83`,
	//+ coordinatey = `308`,
	input_type      = `Filein`,
	filenames       = { `../../global/data/goal-master.txt` },
	file_type       = `column_headers`,
	filename_column = `Filename`,
	aliases         = {
		`Goal Type=Planner Vendor Flag`,
		`Goal ID=Quota Number`,
		`Program Start Year-Month=Program Start Date`,
		`Program End Year-Month=Program End Date`,
		`State=Warehouse State`
	},
	keep_columns    = {
		`Quota Number`,
		`Planner Vendor Flag`,
		`Warehouse State`,
		`Vendor Number`,
		`Program Start Date`,
		`Program End Date`
	}
};

object 'INPT' "Planner Goals Ranges" {
	//+ coordinatex = `233`,
	//+ coordinatey = `308`,
	input_type  = `Filein`,
	filenames   = { `../../global/temp/planner_program_months_original.txt` },
	file_type   = `column_headers`,
	aliases     = {
		`Goal ID=Quota Number`,
		`Program=Quota Description`,
		`Program Start Date=Program Start Date`,
		`Program End Date=Program End Date`
	}
};

object 'INPT' "Salesman/Customer CrossRef" {
	//+ coordinatex = `758`,
	//+ coordinatey = `83`,
	input_type  = `Filein`,
	filenames   = { `../data/msxcmpdd.csv` },
	dictfile    = `../programs/msxcmp.dic`
};

object 'INPT' "Warehouse Master" {
	//+ coordinatex = `383`,
	//+ coordinatey = `83`,
	input_type  = `Filein`,
	filenames   = { `../data/gogwmpdd.csv` },
	dictfile    = `../programs/gogwmp.dic`
};

object 'INPT' "Salesman Master" {
	//+ coordinatex = `833`,
	//+ coordinatey = `83`,
	input_type  = `Filein`,
	filenames   = { `../data/msslmpdd.csv` },
	dictfile    = `../programs/msslmp.dic`
};

object 'INPT' "Customer Master" {
	input_type = `list`,
	columns    = {
	},
	values     = {
	}
};

object 'INPT' "Planner Check" {
	//+ coordinatex = `983`,
	//+ coordinatey = `83`,
	input_type  = `filein`,
	filenames   = { `../temp/planner_check.txt` },
	file_type   = `column_headers`
};

object 'INPT' "Vendor Time" {
	//+ coordinatex = `1058`,
	//+ coordinatey = `83`,
	input_type  = `Filein`,
	file_type   = `column_headers`,
	filenames   = { `../temp/whvendortime.txt` }
};

object 'INPT' "New Customer Master" {
	//+ coordinatex = `833`,
	//+ coordinatey = `233`,
	input_type  = `filein`,
	file_type   = `column_headers`,
	delimiter   = `\t`,
	union       = `true`,
	filenames   = { `../data/customer_master.txt` }
};

object 'PROC' "Time Calcs" {
	//+ coordinatex = `458`,
	//+ coordinatey = `158`,
	process_type = `calc`,
	input        = `Time Lookup`,
	calcs        = {
		{
			name  = `Year2`,
			value = `substr(100+Year,2,2)`
		},
		{
			name  = `Month2`,
			value = `substr(100+Month,2,2)`
		},
		{
			name  = `Year4`,
			value = `concat(Century,Year2)`
		}
	}
};

object 'PROC' "Join Time Lookup" {
	//+ coordinatex = `533`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Join Warehouse Master`,
		`Time Calcs`
	},
	multijoins   = {
		{`Century`, `Century` },
		{`Year`, `Year2` },
		{`Month`, `Month2` },
		{`City Abbrev`, `City Abbrev` }
	}
};

object 'PROC' "Join Item Master" {
	//+ coordinatex = `608`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Join Time Lookup`,
		`Item Master`
	},
	multijoins   = {
		{`Warehouse Number`, `Warehouse Number` },
		{`Item Number`, `Item Number` },
		{`Pack Code`, `Pack Code` }
	}
};

object 'PROC' "Calc Planner VRC Groups" {
	//+ coordinatex = `608`,
	//+ coordinatey = `158`,
	process_type = `calc`,
	input        = `Planner VRC Groups`,
	calcs        = {
		{
			name   = `Vendor Number`,
			value  = `lpad(Vendor Number,7,"0")`,
			update = `true`
		},
		{
			name   = `Vendor RC# Base`,
			value  = `lpad(Vendor RC# Base,2,"0")`,
			update = `true`
		}
	}
};

object 'PROC' "Join Planner VRC Groups" {
	//+ coordinatex = `683`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Join Item Master`,
		`Calc Planner VRC Groups`
	},
	multijoins   = {
		{`Warehouse State`, `Warehouse State` },
		{`Vendor Number`, `Vendor Number` },
		{`Vendor RC# Base`, `Vendor RC# Base` }
	}
};

object 'PROC' "squash Planner goals" {
	//+ coordinatex = `83`,
	//+ coordinatey = `233`,
	process_type = `squash`,
	input        = `planner goals`,
	dimensions   = { `Quota Number`, `Quota Description`, `TY Year-Month` }
};

object 'PROC' "sort Planner goals" {
	//+ coordinatex = `158`,
	//+ coordinatey = `233`,
	process_type = `sort`,
	input        = `squash planner goals`,
	sort_columns = { `TY Year-Month` },
	reverse      = `true`
};

object 'PROC' "Filter Planner Goals Master" {
	//+ notes = ` 1=Vendor, 2=Program`,
	//+ coordinatex = `158`,
	//+ coordinatey = `308`,
	process_type = `filter`,
	input        = `Planner goals Master`,
	action       = `keep`,
	filters      = {
// 1=Vendor, 2=Program
		{
			column = `Planner Vendor Flag`,
			values = { `2` }
		}
	}
};

object 'PROC' "Join Planner Goals Master" {
	//+ coordinatex = `233`,
	//+ coordinatey = `233`,
	process_type = `Lookup`,
	inputs       = {
		`sort Planner Goals`,
		`Filter Planner Goals Master`
	},
	multijoins   = {
		{`Quota Number`, `Quota Number` }
	}
};

object 'PROC' "Join Planner Goals Ranges" {
	//+ coordinatex = `308`,
	//+ coordinatey = `233`,
	process_type = `lookup`,
	inputs       = {
		`Join Planner Goals Master`,
		`Planner Goals Ranges`
	},
	multijoins   = {
		{`Quota Number`, `Quota Number` },
		{`Quota Description`, `Quota Description` }
	}
};

object 'PROC' "Filter Planner Goals" {
// another one to keep successful joins
	//+ notes = ` another one to keep successful joins\n`
		//+ ` 1=Vendor, 2=Program`,
	//+ coordinatex = `383`,
	//+ coordinatey = `233`,
	process_type = `filter`,
	input        = `Join Planner goals ranges`,
	action       = `keep`,
	filters      = {
// 1=Vendor, 2=Program
		{
			column = `Planner Vendor Flag`,
			values = { `2` }
		}
	}
};

object 'PROC' "Planner Goals Calcs" {
	//+ coordinatex = `458`,
	//+ coordinatey = `233`,
	process_type = `calc`,
	input        = `Filter Planner Goals`,
	calcs        = {
		{
			name   = `Vendor Number`,
			value  = `lpad(Vendor Number,7,"0")`,
			update = `true`
		},
		{
			name  = `LY Year-Month`,
			value = `concat(substr(TY Year-Month,1,4)-1,substr(TY Year-Month,5))`
		}
	}
};

object 'PROC' "rotate Planner Goals" {
	//+ coordinatex = `533`,
	//+ coordinatey = `233`,
	process_type     = `rotate`,
	input            = `Planner Goals Calcs`,
	new_horiz_column = `YM Line Type`,
	horiz_values     = { `LY`, `TY` },
	new_value_column = `Rotated Year-Month`,
	horiz_columns    = {
		{`LY Year-Month` },
		{`TY Year-Month` }
	}
};

object 'PROC' "Planner Goals Final Calcs" {
	//+ coordinatex = `608`,
	//+ coordinatey = `233`,
	process_type = `calc`,
	input        = `Rotate Planner Goals`,
	calcs        = {
		{
			name  = `Century`,
			value = `substr(Rotated Year-Month,1,2)`
		},
		{
			name  = `Year`,
			value = `substr(Rotated Year-Month,3,2)`
		},
		{
			name  = `Month`,
			value = `substr(Rotated Year-Month,6,2)`
		}
	}
};

object 'PROC' "Planner Goals Alias" {
	//+ coordinatex = `683`,
	//+ coordinatey = `233`,
	process_type = `alias`,
	input        = `Planner Goals Final Calcs`,
	aliases      = {
	},
	keep_columns = {
		`Century`,
		`Year`,
		`Month`,
		`Warehouse State`,
		`Vendor Number`,
		`Program Start Date`,
		`Program End Date`,
		`Quota Number`,
		`Quota Description`,
		`YM Line Type`,
		`Planner Vendor Flag`
	}
};

object 'PROC' "Join Planner Goals" {
	//+ coordinatex = `758`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Join Planner VRC Groups`,
		`Planner Goals Alias`
	},
	multijoins   = {
		{`Warehouse State`, `Warehouse State` },
		{`Century`, `Century` },
		{`Year`, `Year` },
		{`Month`, `Month` },
		{`Vendor Number`, `Vendor Number` }
	}
};

object 'PROC' "Join SC Xref" {
	//+ coordinatex = `833`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Join Planner Goals`,
		`Salesman/Customer Crossref`
	},
	multijoins   = {
		{`Warehouse Number`, `Warehouse Number` },
		{`Customer Number`, `Customer Number` },
		{`Order Pad Number`, `Order Pad Number` }
	}
};

object 'PROC' "Join Salesman Master" {
	//+ coordinatex = `908`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Join SC Xref`,
		`Salesman Master`
	},
	multijoins   = {
		{`Warehouse Number`, `Warehouse Number` },
		{`Salesman Number`, `Salesman Number` }
	}
};

object 'PROC' "Join Customer Master" {
	//+ coordinatex = `983`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Join Salesman Master`,
		`New Customer Master`
	},
	multijoins   = {
		{`Warehouse Number`, `Warehouse Number` },
		{`Customer Number`, `Customer Number` }
	}
};

object 'PROC' "Join Warehouse Master" {
	//+ coordinatex = `458`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Transaction History`,
		`Warehouse Master`
	},
	multijoins   = {
		{`Warehouse Number`, `Warehouse Number` }
	}
};

object 'PROC' "Join Planner Check" {
	//+ coordinatex = `1058`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`join customer master`,
		`Planner Check`
	},
	multijoins   = {
		{`Warehouse State`, `Warehouse State` },
		{`Vendor Number`, `Vendor Number` }
	}
};

object 'PROC' "Do Calcs" {
	//+ coordinatex = `1133`,
	//+ coordinatey = `8`,
	process_type = `calc`,
	input        = `join planner check`,
	calcs        = {
		{
			name  = `Model Path Calc`,
			value = `replace(replace(Model Path,"year","asjoin"),"mtd","asjoin")`
		},
		{
			name  = `Model`,
			value = `concat(Model Path Calc,"=",Warehouse State,".txt")`
		},
		{
			name  = `Cases`,
			value = `Raw Cases+Bottles/Units Per Case`
		},
		{
			name  = `Premise Code`,
			value = `if(On/Off Premise Code="F",if(or(Establishment Type Code="P",Establishment`
				` Type Code="C"),"F1","F2"),On/Off Premise Code)`
		},
		{
			name  = `On/Off Premise`,
			value = `if(On/Off Premise Code="F","Off Premise",if(On/Off Premise Code="N","On`
				` Premise",if(On/Off Premise Code="M","Military",if(On/Off Premise Code`
				`="C","Consumer",On/Off Premise Code))))`
		},
		{
			name  = `Chain Name`,
			value = `if(Chain Number="000","ZZZ All Others",Chain Name raw)`
		},
		{
			name  = `Corp Chain Name`,
			value = `if(Corp Chain Number="000","ZZZ All Others",Corp Chain Name raw)`
		},
		{
			name  = `VFRP Raw`,
			value = `concat(Vendor Fiscal Month,"-",Year-Mo)`
		},
		{
			name  = `Program Description`,
			value = `Quota Description`
		},
		{
			name   = `Vendor Report Group Desc`,
			value  = `if(Goal Type Flag="",Vendor Report Group Desc,Vendor Report Code Group)`,
			update = `true`
		},
		{
			name   = `Vendor Report Group Number`,
			value  = `if(Goal Type Flag="",Vendor Report Group Number,"")`,
			update = `true`
		}
	}
};

object 'PROC' "Vendor Calcs" {
	//+ coordinatex = `1133`,
	//+ coordinatey = `83`,
	process_type = `calc`,
	input        = `Vendor Time`,
	calcs        = {
		{
			name  = `VFM2`,
			value = `substr(100+Vendor Fiscal Month,2,2)`
		}
	}
};

object 'PROC' "Join Vendor Time" {
	//+ coordinatex = `1208`,
	//+ coordinatey = `8`,
	process_type = `Lookup`,
	inputs       = {
		`Do Calcs`,
		`Vendor Calcs`
	},
	multijoins   = {
		{`Year4`, `Year` },
		{`Month2`, `Month` },
		{`Vendor Fiscal Month`, `VFM2` },
		{`City Abbrev`, `City Abbrev` }
	}
};

object 'PROC' "Filter" {
	//+ coordinatex = `1283`,
	//+ coordinatey = `8`,
	input        = `Join Vendor Time`,
	process_type = `filter`,
	action       = `discard`,
	filters      = {
		{
			column = `FilterCol`,
			values = { `filtermeout` }
		}
	}
};

object 'PROC' "concat-1-CON" {
	process_type = `alias`,
	aliases      = {
	},
	input        = `Customer Master`
};

object 'OUTP' "Split" {
	//+ coordinatex = `1358`,
	//+ coordinatey = `8`,
	output_type     = `split`,
	filename_column = `Model`,
	input           = `Filter`,
	dictfile1       = `../temp/asjoin.dic`,
	columns         = {
		`Warehouse Number`,
		`City Abbrev`,
		`Customer Number`,
		`Business Name`,
		`City`,
		`State`,
		`ZIP Code`,
		`On/Off Premise Code`,
		`On/Off Premise`,
		`Market Type`,
		`Chain Number`,
		`Chain Name`,
		`Corp Chain Number`,
		`Corp Chain Name`,
		`Establishment Type Code`,
		`Establishment Type`,
		`Warehouse Name`,
		`Warehouse City`,
		`Warehouse State`,
		`Warehouse State Name`,
		`Vendor Number`,
		`Vendor Name`,
		`Vendor Fiscal Month`,
		`Fiscal Month Count`,
		`Vendor Report Code`,
		`Vendor RC# Base`,
		`Case Price`,
		`Bottle Price`,
		`Century`,
		`Year`,
		`Month`,
		`Bottles`,
		`Raw Cases`,
		`Gift Pack Conv CD`,
		`Vendor YTD`,
		`Vendor LYTD`,
		`Vendor LY`,
		`YTD`,
		`LYTD`,
		`LY`,
		`MTD`,
		`SMLY`,
		`VFRP`,
		`R12cur`,
		`R12last`
	}
};

object 'INPT' "Customer Master_disabledobject" {
	//+ coordinatex = `833`,
	//+ coordinatey = `158`,
	//+ disabled = `true`,
	input_type  = `Filein`,
	filenames   = { `../data/ok_arcsmpdd.csv` },
	dictfile    = `../programs/arcsmp.dic`
};

object 'PROC' "concat-1-CON_disabledobject" {
	//+ coordinatey = `158`,
	//+ coordinatex = `908`,
	//+ disabled = `true`,
	process_type = `concat`,
	inputs       = {
		`Customer Master`
	}
};

//+audits = {
//+`<2014-06-06>, <Bill Lee>: Modified script`,
//+`<2011-11-17>, <Allison>: Modified script`,
//+}
